define(["Tone/core/Tone"],function(Tone){"use strict";Tone.Analyser=function(){var options=this.optionsObject(arguments,["size","type"],Tone.Analyser.defaults);this._analyser=this.input=this.context.createAnalyser();this._type=options.type;this._returnType=options.returnType;this._buffer=null;this.size=options.size;this.type=options.type;this.returnType=options.returnType;this.minDecibels=options.minDecibels;this.maxDecibels=options.maxDecibels};Tone.extend(Tone.Analyser);Tone.Analyser.defaults={"size":2048,"returnType":"byte","type":"fft","smoothing":0.8,"maxDecibels":-30,"minDecibels":-100};Tone.Analyser.Type={Waveform:"waveform",FFT:"fft"};Tone.Analyser.ReturnType={Byte:"byte",Float:"float"};Tone.Analyser.prototype.analyse=function(){if(this._type===Tone.Analyser.Type.FFT){if(this._returnType===Tone.Analyser.ReturnType.Byte){this._analyser.getByteFrequencyData(this._buffer)}else{this._analyser.getFloatFrequencyData(this._buffer)}}else if(this._type===Tone.Analyser.Type.Waveform){if(this._returnType===Tone.Analyser.ReturnType.Byte){this._analyser.getByteTimeDomainData(this._buffer)}else{this._analyser.getFloatTimeDomainData(this._buffer)}}
return this._buffer};Object.defineProperty(Tone.Analyser.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(size){this._analyser.fftSize=size*2;this.type=this._type}});Object.defineProperty(Tone.Analyser.prototype,"returnType",{get:function(){return this._returnType},set:function(type){if(type===Tone.Analyser.ReturnType.Byte){this._buffer=new Uint8Array(this._analyser.frequencyBinCount)}else if(type===Tone.Analyser.ReturnType.Float){this._buffer=new Float32Array(this._analyser.frequencyBinCount)}else{throw new Error("Invalid Return Type: "+type)}
this._returnType=type}});Object.defineProperty(Tone.Analyser.prototype,"type",{get:function(){return this._type},set:function(type){if(type!==Tone.Analyser.Type.Waveform&&type!==Tone.Analyser.Type.FFT){throw new Error("Invalid Type: "+type)}
this._type=type}});Object.defineProperty(Tone.Analyser.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(val){this._analyser.smoothingTimeConstant=val}});Object.defineProperty(Tone.Analyser.prototype,"minDecibels",{get:function(){return this._analyser.minDecibels},set:function(val){this._analyser.minDecibels=val}});Object.defineProperty(Tone.Analyser.prototype,"maxDecibels",{get:function(){return this._analyser.maxDecibels},set:function(val){this._analyser.maxDecibels=val}});Tone.Analyser.prototype.dispose=function(){Tone.prototype.dispose.call(this);this._analyser.disconnect();this._analyser=null;this._buffer=null};return Tone.Analyser})