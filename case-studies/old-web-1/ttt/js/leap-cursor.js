var LeapElement=function(e){this.element=e,this.cursor=null};LeapElement.prototype={addEventListener:function(){return this.element.addEventListener.apply(this.element,arguments)},removeEventListener:function(){return this.element.removeEventListener.apply(this.element,arguments)},dispatchEvent:function(){return this.element.dispatchEvent.apply(this.element,arguments)},getEventHandler:function(){return this.element.getEventHandler.apply(this.element,arguments)},setEventHandler:function(){return this.element.setEventHandler.apply(this.element,arguments)},isAttractor:function(){return"true"===this.element.getAttribute("leap-attractor")||null!=this.element.getAttribute("leap-attractor-x-padding")&&!isNaN(this.element.getAttribute("leap-attractor-x-padding"))||null!=this.element.getAttribute("leap-attractor-y-padding")&&!isNaN(this.element.getAttribute("leap-attractor-y-padding"))},appendChild:function(e){return e instanceof HTMLElement?this.element.appendChild(e):this.element.appendChild(e.getElement())},removeChild:function(e){return e instanceof HTMLElement?this.element.removeChild(e):this.element.removeChild(e.getElement())},getID:function(){return this.element.id},setStyle:function(e){for(var t in e)this.element.style[t]=e[t]},getParent:function(){return this.element.parentNode},getWidth:function(){return this.element.offsetWidth},getHeight:function(){return this.element.offsetHeight},getElement:function(){return this.element},hasCursor:function(){return null!==this.cursor},capture:function(e){this.cursor=e,this.cursor.capture(this)},release:function(){this.cursor&&(this.cursor.release(),this.cursor=null)},getAttractorPadding:function(){return{x:parseInt(this.element.getAttribute("leap-attractor-x-padding"),10)||0,y:parseInt(this.element.getAttribute("leap-attractor-y-padding"),10)||0}},setAttribute:function(e,t){this.element.setAttribute(e,t)},getClickDelay:function(){return this.element.getAttribute("leap-click-delay")},hasMultitap:function(){return"true"===this.element.getAttribute("leap-enable-multitap")},isTappable:function(){return"true"!==this.element.getAttribute("leap-disable-tap")},isHoverable:function(){return"true"!==this.element.getAttribute("leap-disable-hover")},hasRelay:function(){return null!==this.element.getAttribute("leap-relay")},getRelay:function(){return this.element.getAttribute("leap-relay")},setXY:function(e,t){this.setX(e),this.setY(t)},setX:function(e){this.element.style.left=e+"px"},setY:function(e){this.element.style.top=e+"px"},getX:function(){return this.element.getBoundingClientRect().left},getY:function(){return this.element.getBoundingClientRect().top},scroll:function(e){var t=this.element.clientHeight>this.element.parentElement.clientHeight,i=this.element.clientWidth>this.element.parentElement.clientWidth;this.element===document.body?t>0&&t>i?this.scrollY(e):i>0&&this.scrollX(e):this.element.scrollHeight>this.element.clientHeight?this.scrollY(e):this.element.scrollWidth>this.element.clientWidth&&this.scrollX(e)},scrollX:function(e){this.element.scrollLeft+=e},scrollY:function(e){this.element.scrollTop+=e},addClass:function(e){var t=this.element.className;t&&-1!==t.indexOf(e)||(""!==t&&(e=" "+e),this.element.className=t+e)},removeClass:function(e){var t=this.element.className,i=new RegExp("\\s?\\b"+e+"\\b","g");t=t.replace(i,""),this.element.className=t},fireEvent:function(e){this.element.dispatchEvent(e)}};var LeapManagerUtils=function(){var e={},t=0,i={};return{getLeapElement:function(i){return null==i?null:(i.id||(i.id="leap_element_"+t++),e[i.id]||(e[i.id]=new LeapElement(i)),e[i.id])},isElementVisible:function(e){for(;e!==document.body.parentNode;){if("0"===LeapManagerUtils.getStyle(e,"opacity")||"none"===LeapManagerUtils.getStyle(e,"display")||"hidden"===LeapManagerUtils.getStyle(e,"visibility"))return!1;e=e.parentNode}return!0},getStyle:function(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e)[t]:e.currentStyle?e.currentStyle[t]:void 0},extend:function(e,t){for(var i in t)e[i]=t[i]},extendIf:function(e,t){for(var i in t)t[i]instanceof Object&&t[i].constructor===Object?(void 0!==e[i]&&null!==e[i]||(e[i]={}),LeapManagerUtils.extendIf(e[i],t[i])):void 0!==e[i]&&null!==e[i]||(e[i]=t[i])},exists:function(e){return void 0!==e&&null!==e},bind:function(e,t,i){return function(){i||(i=[]),i=Array.prototype.slice.call(arguments).concat(i),e.apply(t,i)}},map:function(e,t,i,n,r){return e===t?n:(e-t)*(r-n)/(i-t)+n},error:function(e){console.log(e)},testStructure:function(e,t){for(var i,n=0;n<t.length;n++)if("string"==typeof(i=t[n])){if(!LeapManagerUtils.exists(e[i]))return!1;e=e[i]}return!0},createStructure:function(e,t){for(var i,n=!0,r=0;r<t.length;r++)"string"==typeof(i=t[r])&&(LeapManagerUtils.exists(e[i])||(e=e[i]={},n=!1));return n},distance:function(e,t){var i,n;return i=t.x-e.x,i*=i,n=t.y-e.y,n*=n,Math.sqrt(i+n)},getQueryAll:function(e,t,n){return n?(LeapManagerUtils.exists(i[e])||(i[e]=document.querySelectorAll(t)),i[e]):document.querySelectorAll(t)},getQuery:function(e,t){return LeapManagerUtils.exists(i[e])||(i[e]=document.querySelector(t)),i[e]}}}(),Cursor=function(e){if(!e)return LeapManagerUtils.error("Cursor#constructor: You must specify a config object."),null;if(!e.source)return LeapManagerUtils.error("Cursor#constructor: You must specify a `source`."),null;if(!e.id)return LeapManagerUtils.error("Cursor#constructor: You must specify a `id`."),null;if(!e.icon)return LeapManagerUtils.error("Cursor#constructor: You must specify a `icon`."),null;if(LeapManagerUtils.extendIf(e,this.defaultConfig),this.source=e.source,this.id=e.id,this.type=e.type,this.icon=e.icon,this.easing=e.easing,this.clickDelay=e.clickDelay,this.multitapEnabled=e.multitapEnabled,this.virtualParent=e.virtualParent||null,this.virtualParent&&(this.type="virtual",this.setElement(this.virtualParent.getElement()),this.virtualParent.addVirtual(this)),this.virtualCursors=[],(0===this.clickDelay||isNaN(this.clickDelay))&&(this.clickDelay=null),this.onTapUpdate=LeapManagerUtils.bind(this._onTapUpdate,this),this.clickDelay&&this.icon.addClass("leap-timer-cursor"),this.icon instanceof HTMLElement&&(this.icon=new LeapElement(this.icon)),e.position){this.update(e.position.x,e.position.y);var t=this.icon.getWidth()/2,i=this.icon.getHeight()/2;this.icon.setX(e.position.x*window.innerWidth+t),this.icon.setY(e.position.y*window.innerHeight+i)}};Cursor.prototype={x:0,y:0,z:0,X:0,Y:0,Z:0,vX:0,vY:0,vZ:0,enabled:!0,captureHost:null,attractor:null,element:null,isTimerRunning:!1,type:"real",startTime:null,animiationIntervalID:null,state:"up",currentClickDelay:0,defaultConfig:{multitapEnabled:!1,clickDelay:0,easing:.3},_tapCapable:!0,_startPoint:null,onAdded:function(){},onRemoved:function(){},setManager:function(e){this.manager=e},setEnabled:function(e){this.enabled=e},isEnabled:function(){return this.enabled},setElement:function(e){this.element=e},getElement:function(e){return this.element},hasElement:function(){return null!==this.element},onElementOver:function(e){this.setElement(e),this.currentClickDelay=this.element.getClickDelay()||this.clickDelay,e.isHoverable()&&e.addClass("hover"),this._tapCapable&&this.manager.isHoverTapEnabled()&&this.currentClickDelay&&e.isTappable()&&this.startTimer()},onElementDown:function(e){e.addClass("leap-down"),this.icon.addClass("cursor-down"),this.state="down"},onElementMove:function(e){},onElementUp:function(e){this.state="up",e.removeClass("leap-down"),this.icon.removeClass("cursor-down")},onElementOut:function(e){e.isHoverable()&&e.removeClass("hover"),this.manager.isHoverTapEnabled()&&this.currentClickDelay&&e.isTappable()&&this.stopTimer(),this.setElement(null)},isDown:function(){return"down"===this.state},disableTap:function(){this.element&&(this.element.isHoverable()&&this.element.removeClass("hover"),this.currentClickDelay&&this.element.isTappable()&&this.stopTimer()),this._tapCapable=!1},restartTap:function(){this._tapCapable=!0},setAttractor:function(e){this.attractor=e},hasAttractor:function(){return null!==this.attractor},capture:function(e){this.captureHost=e,this.setAttractor(null)},isCaptured:function(){return null!=this.captureHost},release:function(){this.captureHost=null},update:function(e,t,i){this.setPositionX(e),this.setPositionY(t),this.setPositionZ(i)},setPositionX:function(e){this.X=e-this.x,this.x=e},setPositionY:function(e){this.Y=e-this.y,this.y=e},setPositionZ:function(e){this.Z=e-this.z,this.z=e},getX:function(){return this.x},getY:function(){return this.y},getZ:function(){return this.z},setVelocityXYZ:function(e,t,i){this.setVelocityX(e),this.setVelocityY(t),this.setVelocityZ(i)},setVelocityX:function(e){this.vX=e},setVelocityY:function(e){this.vY=e},setVelocityZ:function(e){this.vZ=e},getVelocityX:function(){return this.vX},getVelocityY:function(){return this.vY},getVelocityZ:function(){return this.vZ},getEasing:function(){return this.easing},fireEvent:function(e){this.element&&(e.cursor=this,this.element.fireEvent.apply(this.element,[e]))},startTimer:function(){this.animiationIntervalID&&this.stopTimer(),this.startTime=new Date;var e=this;this.animiationIntervalID=setInterval(function(){e.onTapUpdate()},1e3/30),this.onTimerStart()},stopTimer:function(){clearInterval(this.animiationIntervalID),this.startTime=null,this.onTimerStop()},isVirtual:function(){return"virtual"===this.type},addVirtual:function(e){this.virtualCursors.push(e)},_onTapUpdate:function(){if(this.startTime){var e=new Date-this.startTime;this.onTimerUpdate(e),e>=this.currentClickDelay&&(this.stopTimer(),this.onTimerComplete())}else this.stopTimer()},onTimerStart:function(){this.icon.setStyle({transitionDuration:this.currentClickDelay/1e3+"s"}),this.icon.addClass("active-timer")},onTimerStop:function(){this.icon.setStyle({transitionDuration:"0s"}),this.icon.removeClass("active-timer")},onTimerUpdate:function(e){},onTimerComplete:function(){if(this.element)if(this.dispatchDown(),this.dispatchUp(),this.dispatchClick(),this.dispatchTap(),this.multitapEnabled||this.element.hasMultitap()){var e=this;setTimeout(function(){e.startTimer()},100)}else this.release();else this.release()},dispatchOver:function(e){if(e&&this.setElement(e),this.hasElement()){var t=document.createEvent("MouseEvent");t.initMouseEvent("mouseover",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t),this.onElementOver(this.element)}},dispatchMove:function(e){if(e&&this.setElement(e),this.hasElement()){var t=document.createEvent("MouseEvent");t.initMouseEvent("mousemove",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t),this.onElementMove(this.element),this.manager.isPressDownEnabled()&&this.element.isTappable()&&(!this.isDown()&&this.getZ()<this.manager.getPressThreshold()?this.dispatchDown(e):this.isDown()&&this.getZ()>this.manager.getPressThreshold()&&this.dispatchUp(e))}},dispatchOut:function(e){if(e&&this.setElement(e),this.hasElement()){var t=document.createEvent("MouseEvent");t.initMouseEvent("mouseout",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t),this.isDown()&&this.dispatchUp(e,!1),this.onElementOut(this.element)}},dispatchDown:function(e){if(e&&this.setElement(e),this._startPoint={x:this.icon.getX(),y:this.icon.getY()},this.hasElement()){var t=document.createEvent("MouseEvent");t.initMouseEvent("mousedown",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t),this.onElementDown(this.element)}},dispatchUp:function(e,t){if(LeapManagerUtils.exists(t)||(t=!0),e&&this.setElement(e),this.hasElement()){var i=document.createEvent("MouseEvent");i.initMouseEvent("mouseup",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(i),this.onElementUp(this.element);var n=LeapManagerUtils.distance(this._startPoint,{x:this.icon.getX(),y:this.icon.getY()});t&&n>0&&n<100&&(this.dispatchClick(),this.dispatchTap())}},dispatchClick:function(e){if(e&&this.setElement(e),this.hasElement()){var t=document.createEvent("MouseEvent");t.initMouseEvent("click",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t)}},dispatchTap:function(e){if(e&&this.setElement(e),this.hasElement()){var t=document.createEvent("UIEvent");t.initUIEvent("tap",!0,!0,window,1,this.icon.getX(),this.icon.getY(),this.icon.getX(),this.icon.getY(),!1,!1,!1,!1,0,this.element.element),this.fireEvent(t)}}};var CursorManager=function(e){(this.globalInteractiveSelector=".leap-interactive",this.cursorContainerClass="leap-cursor-container",this.leapCursorClass="leap-cursor",this.interactiveSelector=e.interactiveSelector||null,this.untappableSelector=e.untappableSelector||null,this.pressThreshold=e.pressThreshold||0,this.enableHoverTap=!0===e.enableHoverTap,this.enablePressDown=!0===e.enablePressDown,this.greedySelector=e.greedySelector||null,this.cacheAllQueries=e.cacheAllQueries||!1,this.cursorContainer)||(this.cursorContainer=new LeapElement(document.createElement("div")),(e.root||document.body).appendChild(this.cursorContainer.element),this.cursorContainer.addClass(this.cursorContainerClass),this.cursorContainer.setStyle({zIndex:1e5,position:"fixed",top:"0px",left:"0px"}))};CursorManager.prototype={cursorContainer:null,elementLookup:{},mouseEvent:null,interactiveSelector:"",cursorLookup:{},isHoverTapEnabled:function(){return!0===this.enableHoverTap},isPressDownEnabled:function(){return!0===this.enablePressDown},getPressThreshold:function(){return this.pressThreshold||0},get:function(e,t,i){return null==i&&(i="real"),LeapManagerUtils.createStructure(this.cursorLookup,[i,e]),this.cursorLookup[i][e][t]},add:function(e){var t=e.type||"real",i=e.source||"default",n=e.id||0;return LeapManagerUtils.createStructure(this.cursorLookup,[t,i]),LeapManagerUtils.exists(this.cursorLookup[t][i][n])?this.cursorLookup[t][i][n]:(this.cursorLookup[t][i][n]=e,this.cursorContainer.appendChild(e.icon),e.icon.addClass(this.leapCursorClass),e.setManager(this),e.onAdded(),e)},remove:function(e){var t,i=e.type||"real",n=e.source||"default";e.id;if(!e.isVirtual()&&LeapManagerUtils.testStructure(this.elementLookup,[e.source,e.id])){var r=this.elementLookup[e.source][e.id];r&&r.isAttractor()&&(e.setAttractor(null),r.hasCursor()&&r.release()),r&&this.cursorOut(e,r,{x:e.icon.getX(),y:e.icon.getY()}),this.elementLookup[e.source][e.id]=null}for(var s=0;s<e.virtualCursors.length;s++)t=e.virtualCursors[s],this.removeVirtualCursor(t);return e.virtualCursors=[],e.setManager(null),e.onRemoved(),LeapManagerUtils.exists(e.icon.getParent())&&this.cursorContainer.removeChild(e.icon),LeapManagerUtils.testStructure(this.cursorLookup,[i,n])&&(this.cursorLookup[i][n][e.id]=null,delete this.cursorLookup[i][n][e.id]),!0},pruneCursors:function(e,t,i){if(LeapManagerUtils.exists(i)||(i="real"),LeapManagerUtils.testStructure(this.cursorLookup,[i,e])){var n,r,s=[];for(r in this.cursorLookup[i][e])(n=this.cursorLookup[i][e][r])instanceof Cursor&&-1===t.indexOf(n.id)&&s.push(n);for(var o=0;o<s.length;o++)this.remove(s[o])}},update:function(){var e,t,i,n,r,s,o,a,l,c,u,h,p,d,g;for(p in this.cursorLookup)for(d in this.cursorLookup[p])for(g in this.cursorLookup[p][d])if((h=this.cursorLookup[p][d][g])instanceof Cursor){if(h.isVirtual()){h.icon.setX(h.icon.getX()+h.getVelocityX()),h.icon.setY(h.icon.getY()+h.getVelocityY());continue}if(this.elementLookup[h.source]||(this.elementLookup[h.source]={}),this.elementLookup[h.source][h.id]||(this.elementLookup[h.source][h.id]=null),e={x:Math.round(h.getX()*window.innerWidth),y:Math.round(h.getY()*window.innerHeight)},u=this.elementLookup[h.source][h.id],!h.isEnabled()){u&&(u.isAttractor()&&(h.setAttractor(null),u.hasCursor()&&u.release()),this.cursorOut(h,u),this.elementLookup[h.source][h.id]=null);continue}o=h.icon.getWidth()/2,a=h.icon.getHeight()/2,h.isCaptured()||(h.attractor?(l=h.attractor.element.getBoundingClientRect(),i=(t={x:Math.round(l.left+l.width/2-o),y:Math.round(l.top+l.height/2-a)}).x-h.icon.getX(),n=t.y-h.icon.getY(),r=Math.abs(i/(l.width/2)),s=Math.abs(n/(l.height/2)),r>1&&(r=1),s>1&&(s=1),r=Math.abs(1-r),s=Math.abs(1-s),h.setVelocityXYZ(i*Math.max(.1,Math.min(1,r)),n*Math.max(.1,Math.min(1,s)),0),Math.abs(h.getVelocityX())<=.1&&Math.abs(h.getVelocityY())<=.1&&(h.setVelocityXYZ(0,0,0),h.icon.setX(t.x),h.icon.setY(t.y),h.attractor.capture(h))):(i=e.x-o-h.icon.getX(),n=e.y-a-h.icon.getY(),h.setVelocityXYZ(i*h.getEasing(),n*h.getEasing()))),h.icon.setX(h.icon.getX()+h.getVelocityX()),h.icon.setY(h.icon.getY()+h.getVelocityY()),u=this.getCollidingElements(e),c=this.elementLookup[h.source][h.id],u&&(null==c&&(this.elementLookup[h.source][h.id]=u,u.isAttractor()&&!u.hasCursor()&&null==h.attractor&&null==h.captureHost&&h.setAttractor(u),this.cursorOver(h,u)),this.cursorMove(h,u)),c&&c!==u&&(c.isAttractor()&&(h.setAttractor(null),c.hasCursor()&&c.release(h)),this.cursorOut(h,c),this.elementLookup[h.source][h.id]=u,u&&(this.cursorOver(h,u),u.isAttractor()&&null==h.attractor&&null==h.captureHost&&(u.hasCursor()||h.setAttractor(u))))}},cursorOver:function(e,t){e.dispatchOver(t)},cursorMove:function(e,t){e.dispatchMove(t)},cursorOut:function(e,t){e.dispatchOut(t)},cursorDown:function(e,t){e.dispatchDown(t)},cursorUp:function(e,t){e.dispatchUp(t)},getCollidingElements:function(e){var t=this.globalInteractiveSelector;"string"==typeof this.interactiveSelector&&this.interactiveSelector.length>0&&(t+=", "+this.interactiveSelector);var i,n,r,s,o,a,l,c=LeapManagerUtils.getQueryAll("interactiveElements",t)||[];for(r=c.length-1;r>=0;r--)if(s=c[r],LeapManagerUtils.isElementVisible(s)&&(o=s.getBoundingClientRect(),(s=LeapManagerUtils.getLeapElement(s))&&(i=s.isAttractor()?s.getAttractorPadding().x:0,n=s.isAttractor()?s.getAttractorPadding().y:0,a=e.x>o.left-i&&e.x<o.left+o.width+i,l=e.y>o.top-n&&e.y<o.top+o.height+n,a&&l&&(s.hasRelay()&&(s=LeapManagerUtils.getLeapElement(LeapManagerUtils.getQuery(s.getID()+"-relay",s.getRelay()))),s)))){if(s.isTappable()&&"string"==typeof this.untappableSelector&&this.untappableSelector.length>0){var u=LeapManagerUtils.getQueryAll("untappableElements",this.untappableSelector,this.cacheAllQueries)||[];for(r=0;r<u.length;r++)if(u[r]===s.getElement()){s.setAttribute("leap-disable-tap","true");break}}return s}return null!==this.greedySelector?((s=LeapManagerUtils.getLeapElement(LeapManagerUtils.getQuery("greedySelector",this.greedySelector))).hasRelay()&&(s=LeapManagerUtils.getLeapElement(LeapManagerUtils.getQuery(s.getID()+"-relay",s.getRelay()))),s):null},getVirtualCursor:function(e,t){return this.get(e,t,"virtual")},addVirtualCursor:function(e){return this.add(e)},removeVirtualCursor:function(e){return this.remove(e)}};var MouseSimulator={cursorManager:null,mouseCursor:null,init:function(e,t){this.cursorManager=e;var i=new LeapElement(document.createElement("div"));i.addClass("leap-mouse-cursor");var n={source:"mouse",id:1,icon:i};LeapManagerUtils.extendIf(n,t),this.mouseCursor=new Cursor(n),this.enable()},enable:function(){this._onMouseMove=LeapManagerUtils.bind(this.onMouseMove,this),this._onMouseClick=LeapManagerUtils.bind(this.onMouseClick,this),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("click",this._onMouseClick),this.cursorManager.add(this.mouseCursor)},disable:function(){this.mouseCursor&&(document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("click",this._onMouseClick),this.cursorManager.remove(this.mouseCursor),this.mouseCursor=null)},update:function(e,t,i){this.mouseCursor.update(e,t,i)},onMouseMove:function(e){var t,i=0,n=0;(e=e||window.e).pageX||e.pageY?(i=e.pageX,n=e.pageY):(i=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scollTop+document.documentElement.scrollTop),i/=window.innerWidth,n/=window.innerHeight,t=this.currentZ,this.update(i,n,t)},onMouseClick:function(e){}},DualSwipe=function(e,t,i){this.firstGesture=e,this.secondGesture=t,this.direction=i,this.type="dual-swipe",this.state="stop"},LeapManager=function(){"use strict";var e="leap-pointable-cursor",t="leap",i={maxCursors:1,enableFrameScrolling:!1,enableTouchScrolling:!1,enableScrollbarScrolling:!0,enableHoverTap:!0,enablePressDown:!1,pressThreshold:0,simulateWithMouse:!1,enableInBackground:!1,cacheQueries:!0,enableMetaGestures:!0,enableDefaultMetaGestureActions:!0,metaGestureMaxDelay:1200,greedySelector:null,cacheAllQueries:!1,root:null,gestureCallback:null,gestureScope:null,frameCallback:null,interactiveSelector:null,enableSenchaTouch:!1,boundary:{top:350,left:-100,right:100,bottom:150},frameScrollingConfig:{treshold:.1618,speed:5},touchScrollingConfig:{scrollVector:{x:0,y:1,z:0},scrollMaxSpeed:7,scrollMinSpeed:2,scrollMaxDuration:6},scrollbarScrollingConfig:{resetDelay:1e3,scrollMaxSpeed:7,scrollMinSpeed:2,scrollMaxDuration:6},cursorConfig:{multitapEnabled:!1,clickDelay:1e3},mouseCursorConfig:{multitapEnabled:!1,clickDelay:1e3},loopConfig:{enableGestures:!0}};return{cursorManager:null,gestureHistory:{},init:function(e){LeapManagerUtils.extendIf(e,i),this.boundary=e.boundary,this.maxCursors=e.maxCursors,this.simulateWithMouse=e.simulateWithMouse,this.gestureCallback=e.gestureCallback,this.gestureScope=e.gestureScope,this.frameCallback=e.frameCallback,this.cursorConfig=e.cursorConfig,this.enableFrameScrolling=e.enableFrameScrolling,this.frameScrollingConfig=e.frameScrollingConfig,this.enableTouchScrolling=e.enableTouchScrolling,this.touchScrollingConfig=e.touchScrollingConfig,this.enableScrollbarScrolling=e.enableScrollbarScrolling,this.scrollbarScrollingConfig=e.scrollbarScrollingConfig,this.enableMetaGestures=e.enableMetaGestures,this.enableDefaultMetaGestureActions=e.enableDefaultMetaGestureActions,this.metaGestureMaxDelay=e.metaGestureMaxDelay||500,e.enableSenchaTouch&&(null==e.interactiveSelector?e.interactiveSelector="":e.interactiveSelector+=",",e.interactiveSelector+=["a",".x-tab",".x-button",".x-video-ghost",".x-scroll-scroller",".x-list-item"].join(","),e.untappableSelector=[".x-scroll-scroller"].join(", ")),this.cursorManager=new CursorManager({root:e.root,interactiveSelector:e.interactiveSelector,untappableSelector:e.untappableSelector,enableHoverTap:e.enableHoverTap,enablePressDown:e.enablePressDown,pressThreshold:e.pressThreshold,greedySelector:e.greedySelector,cacheAllQueries:e.cacheAllQueries}),this.simulateWithMouse&&MouseSimulator.init(this.cursorManager,e.mouseCursorConfig||{});var t=this;t.isActiveWindow=!0,e.enableInBackground||(window.addEventListener("blur",function(){t.isActiveWindow=!1}),window.addEventListener("focus",function(){t.isActiveWindow=!0}));var n=this.loopCallback=function(e){t.onLoop(e)};null!==Leap&&Leap.loop(e.loopConfig,n)},exit:function(){null!==Leap&&Leap.loopController&&this.loopCallback&&Leap.loopController.removeListener(Leap.loopController.frameEventName,this.loopCallback),this.updatePointables(Leap.Frame.Invalid),this.updateGestures(Leap.Frame.Invalid),this.loopCallback=null,this.cursorManager.cursorContainer.element.parentNode.removeChild(this.cursorManager.cursorContainer.element)},onLoop:function(e){this.isActiveWindow&&(this.cursorManager.update(),this.updateHand(e),this.frameCallback&&this.frameCallback.call(this,e))},updateHand:function(e){var i=[];if(e&&e.hands&&e.hands[0]){var n=e.hands[0],r=n.palmPosition,s=LeapManagerUtils.map(r[0],this.boundary.left,this.boundary.right,0,1),o=LeapManagerUtils.map(r[1],this.boundary.bottom,this.boundary.top,1,0),a=r[2],l=this.getCursor(n.id,{x:s,y:o,z:a});i.push(l.id),l.update(s,o,a),this.scrollIfNeeded(o)}this.cursorManager.pruneCursors(t,i)},scrollIfNeeded:function(e){this.enableFrameScrolling&&(e>1-this.frameScrollingConfig.treshold?window.scrollBy(0,this.frameScrollingConfig.speed):e<this.frameScrollingConfig.treshold&&window.scrollBy(0,-1*this.frameScrollingConfig.speed))},updatePointables:function(e){var i,n,r,s,o,a,l=[];if(e&&e.pointables)for(n=0;n<e.pointables.length&&n<this.maxCursors;n++)(i=e.pointables[n])&&(s=LeapManagerUtils.map(i.tipPosition[0],this.boundary.left,this.boundary.right,0,1),o=LeapManagerUtils.map(i.tipPosition[1],this.boundary.bottom,this.boundary.top,1,0),a=i.tipPosition[2],r=this.getCursor(i.id,{x:s,y:o,z:a}),l.push(r.id),r.update(s,o,a));this.cursorManager.pruneCursors(t,l)},getCursor:function(i,n){var r=this.cursorManager.get(t,i);if(r)return r;var s=new LeapElement(document.createElement("div"));s.addClass(e);var o={source:t,id:i,position:n,icon:s};return LeapManagerUtils.extend(o,this.cursorConfig),r=new Cursor(o),this.cursorManager.add(r),r},updateGestures:function(i){var n,r=this;i.gestures.length>0&&i.gestures.forEach(function(i){if(i.pointableIds&&i.pointableIds.length>0&&i.pointableIds.forEach(function(s){if((n=r.cursorManager.get(t,s))instanceof Cursor){if(n.hasElement()){var o=document.createEvent("Event");o.initEvent("leap-"+i.type,!0,!0),o.state=i.state,o.gesture=i,n.element.fireEvent(o),(o=document.createEvent("Event")).initEvent("leap-"+i.type+"-"+i.state,!0,!0),o.state=i.state,o.gesture=i,n.element.fireEvent(o)}if(r.gestureCallback&&r.gestureCallback.call(r.gestureScope||r,i),(r.enableTouchScrolling||r.enableScrollbarScrolling)&&"circle"===i.type){var a,l={x:LeapManagerUtils.map(i.center[0],r.boundary.left,r.boundary.right,0,1),y:LeapManagerUtils.map(i.center[1],r.boundary.bottom,r.boundary.top,1,0),z:0},c="leap-scroller",u=r.cursorManager.getVirtualCursor(c,i.id);if(r.enableTouchScrolling)if("start"===i.state){n.disableTap(),u&&r.removeVirtualCursor(u);var h=new LeapElement(document.createElement("div"));h.addClass(e),h.addClass("leap-pointable-virtual-cursor"),h.addClass("leap-pointable-virtual-scroller-cursor");var p={source:c,id:i.id,position:l,icon:h};p.virtualParent=n,(u=new Cursor(p)).onAdded=function(){this.dispatchDown()},u.onRemoved=function(){this.setVelocityXYZ(0,0,0),this.dispatchUp()},r.cursorManager.addVirtualCursor(u)}else"stop"===i.state&&u?(n.restartTap(),r.cursorManager.removeVirtualCursor(u)):u&&(a=LeapManagerUtils.map(i.duration/1e6,0,r.touchScrollingConfig.scrollMaxDuration,r.touchScrollingConfig.scrollMinSpeed,r.touchScrollingConfig.scrollMaxSpeed),i.normal[2]>0?u.setVelocityXYZ(a*r.touchScrollingConfig.scrollVector.x,a*r.touchScrollingConfig.scrollVector.y,a*r.touchScrollingConfig.scrollVector.z):u.setVelocityXYZ(a*-r.touchScrollingConfig.scrollVector.x,a*-r.touchScrollingConfig.scrollVector.y,a*-r.touchScrollingConfig.scrollVector.z),u.dispatchMove());else if(r.enableScrollbarScrolling)if("start"===i.state){if(LeapManagerUtils.exists(n._lastElementTime))new Date-n._lastElementTime>r.scrollbarScrollingConfig.resetDelay&&(n._scrollElement=n.getElement());n._lastElementTime=new Date,n.getElement()&&!LeapManagerUtils.exists(n._scrollElement)&&(n._scrollElement=n.getElement()),LeapManagerUtils.exists(n._scrollElement)&&n.disableTap()}else"update"===i.state?LeapManagerUtils.exists(n._scrollElement)&&(n._lastElementTime=new Date,a=LeapManagerUtils.map(i.duration/1e6,0,r.scrollbarScrollingConfig.scrollMaxDuration,r.scrollbarScrollingConfig.scrollMinSpeed,r.scrollbarScrollingConfig.scrollMaxSpeed),i.normal[2]>0?n._scrollElement.scroll(-a):n._scrollElement.scroll(a)):"end"===i.state&&n.restartTap()}}}),r.enableMetaGestures&&"stop"===i.state&&"swipe"===i.type){r.gestureHistory[i.type]instanceof Array||(r.gestureHistory[i.type]=[]),i.timestamp=(new Date).getTime();var s,o,a=0,l=0,c=0;for(s=0;s<2;s++)Math.abs(i.direction[s])>a&&(a=Math.abs(i.direction[s]),l=s);if(i._direction=0===l?i.direction[0]>0?"right":"left":1===l?i.direction[1]>0?"up":"down":i.direction[2]>0?"backward":"forward",r.gestureHistory[i.type].push(i),2===r.gestureHistory[i.type].length&&(o=r.gestureHistory[i.type][0],i._direction===o._direction&&(c=i.timestamp-o.timestamp,console.log(c),c<r.metaGestureMaxDelay))){var u=new DualSwipe(i,o,i._direction);r.gestureCallback&&r.gestureCallback.call(r.gestureScope||r,u);var h=document.createEvent("Event");if(h.initEvent("leap-"+u.type,!0,!0),h.state=i.state,h.gesture=u,document.body.dispatchEvent(h),r.enableDefaultMetaGestureActions)switch(u.direction){case"left":history.back();break;case"right":history.forward()}}for(;r.gestureHistory[i.type].length>1;)r.gestureHistory[i.type].shift()}})}}}();